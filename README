
http2::HTTP2
=================================

This plugin provides an HTTP2 (RFC 7540 - https://tools.ietf.org/html/rfc7540)
decoder/analyzer for Bro (https://www.bro.org/).

The events exposed attempt to mimic the events exposed by the native HTTP analyzer

Installation
____________

Requirements
````````````
NGHTTP2 1.11.0 or greater is required. The plugin uses the decompression 
libraries and some portions of the API used are not supported prior to that 
version.

    nghttp2 Library - https://github.com/nghttp2/nghttp2

On Ubuntu 16.04:

    # sudo apt-get install libnghttp2-dev

On CentOS 7:

    # sudo yum install libnghttp2-devel


Brotli is required as it is used quite often by popular websites and it
is used to decompress data frames.

    brotli Library  - https://github.com/google/brotli

On Ubuntu 16.04 & CentOS 7:

    Manually build and install the library as specified in the above reference.


Manual Install
``````````````

To manually build and install the plugin:

    cd <HTTP2 Plugin Directory>
    ./configure --bro-dist=</path/to/bro/source>
    make
    make install

You should see the following output from bro if successfully installed:

    > bro -NN http2::HTTP2
    http2::HTTP2 - Hypertext Transfer Protocol Version 2 analyzer (dynamic, version 0.2)
        [Analyzer] HTTP2 (ANALYZER_HTTP2, enabled)
        [Event] http2_request
        [Event] http2_reply
        [Event] http2_stream_start
        [Event] http2_stream_end
        [Event] http2_header
        [Event] http2_all_headers
        [Event] http2_begin_entity
        [Event] http2_end_entity
        [Event] http2_entity_data
        [Event] http2_content_type
        [Event] http2_event
        [Event] http2_data_event
        [Event] http2_header_event
        [Event] http2_priority_event
        [Event] http2_rststream_event
        [Event] http2_settings_event
        [Event] http2_pushpromise_event
        [Event] http2_ping_event
        [Event] http2_goaway_event
        [Event] http2_windowupdate_event
        [Event] http2_continuation_event
        [Type] http2_settings_unrecognized_table
        [Type] http2_settings
        [Type] http2_stream_stat


Bro Package Manager (Future)
````````````````````````````

Install this plugin through the Bro Package Manager::

    # bro-pkg install mitrecnd/bro-http2


Usage
_____

To use/load the http2 analyzer, add the following to your config:

    @load http2

The analyzer will create a new log file called "http2.log"
